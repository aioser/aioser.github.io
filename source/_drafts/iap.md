---
title: iap
---

#### 什么是iap
    - 概念
        - 基础
    - 分类
        - 消耗型项目: 只可使用一次的产品，使用之后即失效，必须再次购买。
            示例：钓鱼 App 中的鱼食。
        - 非消耗型项目: 只需购买一次，不会过期或随着使用而减少的产品。
            示例：游戏 App 的赛道。
        - 非续期订阅: 允许用户购买有时限性服务的产品。此 App 内购买项目的内容可以是静态的。此类订阅不会自动续期。
            示例：为期一年的已归档文章目录订阅。
#### StoreKit实践
    - 通用
        - 基础
            - 逻辑
            - note
                - applicationUsername 作用
                - 4个status
                - `finishQueue`
        - sandbox环境
        - 验证逻辑
            - 客户端验证
                - note:
                    - 修改本地时间
            - 服务端验证
                - 回执信息存储
                - 轮询
    - 问题:
        - 订阅问题
        - 退款问题
#### server-to-server notification
    - 订阅类型状态变更
    - wwdc2020 新增退款推送
#### StoreKitTest
    - 配置

